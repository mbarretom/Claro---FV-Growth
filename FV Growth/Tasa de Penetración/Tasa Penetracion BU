-- Potencial Disponible  

SELECT 
	'PREPAGO',
    COUNT(DISTINCT CASE WHEN B_PREPAGO = 'TRUE' THEN TELE_NUMB END ) AS POTENCIAL_TOTAL,
    COUNT(DISTINCT CASE WHEN B_PREPAGO = 'TRUE' AND CANAL_SMS = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_SMS, 
    COUNT(DISTINCT CASE WHEN B_PREPAGO = 'TRUE' AND CANAL_RCS = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_RCS, 
    COUNT(DISTINCT CASE WHEN B_PREPAGO = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_SAT_PUSH,
    COUNT(DISTINCT CASE WHEN B_PREPAGO = 'TRUE' AND CANAL_WHATSAPP = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_WHATSAPP,
    COUNT(DISTINCT CASE WHEN B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_PUSH_APP,
    COUNT(DISTINCT CASE WHEN B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_PUSH_COTA,                 
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_SMS ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_SMS,
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_RCS ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_RCS,
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_SAT_PUSH ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_SAT_PUSH,
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_WHATSAPP ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_WHATSAPP,
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_NOTIFICACION_PUSH_APP,       
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_NOTIFICACION_PUSH_COTA ,              
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_SMS = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_SMS,
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_RCS= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_RCS,        
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_SAT_PUSH,
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_WHATSAPP = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_WHATSAPP,        
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_NOTIFICACION_PUSH_APP,   
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_NOTIFICACION_PUSH_COTA,          
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_SMS = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_SMS,     
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_RCS = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_RCS,        
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_SAT_PUSH,
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_WHATSAPP= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_WHATSAPP,        
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_NOTIFICATION_PUSH_APP,     
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_NOTIFICATION_PUSH_COTA,                  
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_SMS = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_SMS,
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_RCS = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_SMS,        
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_SAT_PUSH= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_SAT_PUSH,
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_WHATSAPP= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_WHATSAPP,
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_CANAL_NOTIFICATION_PUSH_APP,     
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_CANAL_NOTIFICATION_PUSH_COTA           
FROM INNOVACION.POTENCIAL_CAMPANA A
WHERE A.EXCLUSION_COMERCIAL IS NULL
  AND A.GRUPO_CONTROL IS NULL
UNION ALL 
SELECT 
	'POSPAGO',
    COUNT(DISTINCT CASE WHEN B_POSPAGO = 'TRUE' THEN TELE_NUMB END ) AS POTENCIAL_TOTAL,
    COUNT(DISTINCT CASE WHEN B_POSPAGO = 'TRUE' AND CANAL_SMS = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_SMS, 
    COUNT(DISTINCT CASE WHEN B_POSPAGO = 'TRUE' AND CANAL_RCS = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_RCS, 
    COUNT(DISTINCT CASE WHEN B_POSPAGO = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_SAT_PUSH,
    COUNT(DISTINCT CASE WHEN B_POSPAGO = 'TRUE' AND CANAL_WHATSAPP = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_WHATSAPP,
    COUNT(DISTINCT CASE WHEN B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_PUSH_APP,
    COUNT(DISTINCT CASE WHEN B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_PUSH_COTA,                 
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_SMS ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_SMS,
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_RCS ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_RCS,
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_SAT_PUSH ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_SAT_PUSH,
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_WHATSAPP ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_WHATSAPP,
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_NOTIFICACION_PUSH_APP,       
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_NOTIFICACION_PUSH_COTA ,              
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_SMS = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_SMS,
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_RCS= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_RCS,        
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_SAT_PUSH,
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_WHATSAPP = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_WHATSAPP,        
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_NOTIFICACION_PUSH_APP,   
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_NOTIFICACION_PUSH_COTA,          
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_SMS = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_SMS,     
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_RCS = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_RCS,        
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_SAT_PUSH,
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_WHATSAPP= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_WHATSAPP,        
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_NOTIFICATION_PUSH_APP,     
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_NOTIFICATION_PUSH_COTA,                  
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_SMS = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_SMS,
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_RCS = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_SMS,        
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_SAT_PUSH= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_SAT_PUSH,
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_WHATSAPP= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_WHATSAPP,
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_CANAL_NOTIFICATION_PUSH_APP,     
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_CANAL_NOTIFICATION_PUSH_COTA           
FROM INNOVACION.POTENCIAL_CAMPANA A
WHERE A.EXCLUSION_COMERCIAL IS NULL
  AND A.GRUPO_CONTROL IS NULL
UNION ALL 
SELECT 
	'HOGAR',
    COUNT(DISTINCT CASE WHEN B_HOGAR = 'TRUE' THEN TELE_NUMB END ) AS POTENCIAL_TOTAL,
    COUNT(DISTINCT CASE WHEN B_HOGAR = 'TRUE' AND CANAL_SMS = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_SMS, 
    COUNT(DISTINCT CASE WHEN B_HOGAR = 'TRUE' AND CANAL_RCS = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_RCS, 
    COUNT(DISTINCT CASE WHEN B_HOGAR = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_SAT_PUSH,
    COUNT(DISTINCT CASE WHEN B_HOGAR = 'TRUE' AND CANAL_WHATSAPP = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_WHATSAPP,
    COUNT(DISTINCT CASE WHEN B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_PUSH_APP,
    COUNT(DISTINCT CASE WHEN B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE' THEN TELE_NUMB END) AS POTENCIAL_PUSH_COTA,                 
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_SMS ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_SMS,
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_RCS ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_RCS,
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_SAT_PUSH ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_SAT_PUSH,
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_WHATSAPP ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_WHATSAPP,
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_NOTIFICACION_PUSH_APP,       
    COUNT(DISTINCT CASE 
        WHEN A.P_MIGRA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA ='TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_MIGRACION_NOTIFICACION_PUSH_COTA ,              
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_SMS = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_SMS,
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_RCS= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_RCS,        
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_SAT_PUSH,
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_WHATSAPP = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_WHATSAPP,        
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_NOTIFICACION_PUSH_APP,   
    COUNT(DISTINCT CASE 
        WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_NOTIFICACION_PUSH_COTA,          
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_SMS = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_SMS,     
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_RCS = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_RCS,        
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_SAT_PUSH,
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_WHATSAPP= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_WHATSAPP,        
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_NOTIFICATION_PUSH_APP,     
    COUNT(DISTINCT CASE 
        WHEN A.P_TYT = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_TYT_NOTIFICATION_PUSH_COTA,                  
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_SMS = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_SMS,
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_RCS = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_SMS,        
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_SAT_PUSH= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_SAT_PUSH,
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_WHATSAPP= 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_WHATSAPP,
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_CANAL_NOTIFICATION_PUSH_APP,     
    COUNT(DISTINCT CASE 
        WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE'
        THEN TELE_NUMB END) AS POTENCIAL_OTT_CANAL_NOTIFICATION_PUSH_COTA           
FROM INNOVACION.POTENCIAL_CAMPANA A
WHERE A.EXCLUSION_COMERCIAL IS NULL
  AND A.GRUPO_CONTROL IS NULL


-- Envíos de Potencial
    
    SELECT 
    	'PREPAGO',
        COUNT(DISTINCT CASE WHEN B_PREPAGO = 'TRUE' AND C.SEGMENT = 'PREPAGO' THEN A.TELE_NUMB END ) AS POTENCIAL_TOTAL,
        COUNT(DISTINCT CASE WHEN B_PREPAGO = 'TRUE' AND CANAL_SMS = 'TRUE' AND C.SEGMENT = 'PREPAGO' THEN A.TELE_NUMB END) AS POTENCIAL_SMS, 
        COUNT(DISTINCT CASE WHEN B_PREPAGO = 'TRUE' AND CANAL_RCS = 'TRUE' AND C.SEGMENT = 'PREPAGO' THEN A.TELE_NUMB END) AS POTENCIAL_RCS, 
        COUNT(DISTINCT CASE WHEN B_PREPAGO = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE'AND C.SEGMENT = 'PREPAGO' THEN A.TELE_NUMB END) AS POTENCIAL_SAT_PUSH,
        COUNT(DISTINCT CASE WHEN B_PREPAGO = 'TRUE' AND CANAL_WHATSAPP = 'TRUE' AND C.SEGMENT = 'PREPAGO' THEN A.TELE_NUMB END) AS POTENCIAL_WHATSAPP,
        COUNT(DISTINCT CASE WHEN B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP = 'TRUE' AND C.SEGMENT = 'PREPAGO' THEN A.TELE_NUMB END) AS POTENCIAL_PUSH_APP,
        COUNT(DISTINCT CASE WHEN B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE' AND C.SEGMENT = 'PREPAGO' THEN A.TELE_NUMB END) AS POTENCIAL_PUSH_COTA,                 
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_SMS ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_SMS,
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_RCS ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_RCS,
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_SAT_PUSH ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_SAT_PUSH,
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_WHATSAPP ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_WHATSAPP,
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_NOTIFICACION_PUSH_APP,       
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_NOTIFICACION_PUSH_COTA ,              
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_SMS = 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_SMS,
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_RCS= 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_RCS,        
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_SAT_PUSH, 
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_WHATSAPP = 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_WHATSAPP,        
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP= 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_NOTIFICACION_PUSH_APP,   
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA= 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_NOTIFICACION_PUSH_COTA,          
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_SMS = 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_SMS,     
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_RCS = 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_RCS,        
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_SAT_PUSH,
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_WHATSAPP= 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_WHATSAPP,        
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP= 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_NOTIFICATION_PUSH_APP,     
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_NOTIFICATION_PUSH_COTA,                  
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_SMS = 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_SMS,
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_RCS = 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_SMS,        
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_SAT_PUSH= 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_SAT_PUSH,
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_WHATSAPP= 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_WHATSAPP,
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP = 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_CANAL_NOTIFICATION_PUSH_APP,      
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_PREPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_CANAL_NOTIFICATION_PUSH_COTA           
    FROM POTENCIAL_CAMPANA A
    JOIN VW_TBL_FACT_AUT_TCM B
    ON RIGHT(A.TELE_NUMB,10) = RIGHT(B.TELE_NUMB,10) 
    JOIN GROWTH_CAMPAIGN_OPTION C
    ON B.NEMOTECNIA = C.NEMOTECNIA
    WHERE A.EXCLUSION_COMERCIAL IS NULL
      AND A.GRUPO_CONTROL IS NULL
      AND B.BAN_AUTORIZACION_ENVIO = 'SI'
      AND TRUNC(B.FECHA) >= DATE '2025-09-01'
    UNION ALL 
    SELECT 
    	'POSPAGO',
        COUNT(DISTINCT CASE WHEN B_POSPAGO = 'TRUE' THEN A.TELE_NUMB END ) AS POTENCIAL_TOTAL,
        COUNT(DISTINCT CASE WHEN B_POSPAGO = 'TRUE' AND CANAL_SMS = 'TRUE' THEN A.TELE_NUMB END) AS POTENCIAL_SMS, 
        COUNT(DISTINCT CASE WHEN B_POSPAGO = 'TRUE' AND CANAL_RCS = 'TRUE' THEN A.TELE_NUMB END) AS POTENCIAL_RCS, 
        COUNT(DISTINCT CASE WHEN B_POSPAGO = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE' THEN A.TELE_NUMB END) AS POTENCIAL_SAT_PUSH,
        COUNT(DISTINCT CASE WHEN B_POSPAGO = 'TRUE' AND CANAL_WHATSAPP = 'TRUE' THEN A.TELE_NUMB END) AS POTENCIAL_WHATSAPP,
        COUNT(DISTINCT CASE WHEN B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP = 'TRUE' THEN A.TELE_NUMB END) AS POTENCIAL_PUSH_APP,
        COUNT(DISTINCT CASE WHEN B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE' THEN A.TELE_NUMB END) AS POTENCIAL_PUSH_COTA,                 
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_SMS ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_SMS,
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_RCS ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_RCS,
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_SAT_PUSH ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_SAT_PUSH,
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_WHATSAPP ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_WHATSAPP,
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_NOTIFICACION_PUSH_APP,       
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_NOTIFICACION_PUSH_COTA ,              
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_SMS = 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_SMS,
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_RCS= 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_RCS,        
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_SAT_PUSH,
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_WHATSAPP = 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_WHATSAPP,        
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP= 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_NOTIFICACION_PUSH_APP,   
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA= 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_NOTIFICACION_PUSH_COTA,          
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_SMS = 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_SMS,      
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_RCS = 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_RCS,        
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_SAT_PUSH,
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_WHATSAPP= 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_WHATSAPP,        
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP= 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_NOTIFICATION_PUSH_APP,     
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_NOTIFICATION_PUSH_COTA,                  
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_SMS = 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_SMS,
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_RCS = 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_SMS,        
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_SAT_PUSH= 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_SAT_PUSH,
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_WHATSAPP= 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_WHATSAPP,
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP = 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_CANAL_NOTIFICATION_PUSH_APP,     
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_POSPAGO = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_CANAL_NOTIFICATION_PUSH_COTA           
    FROM POTENCIAL_CAMPANA A
    JOIN VW_TBL_FACT_AUT_TCM B
    ON RIGHT(A.TELE_NUMB,10) = RIGHT(B.TELE_NUMB,10) 
    JOIN GROWTH_CAMPAIGN_OPTION C
    ON B.NEMOTECNIA = C.NEMOTECNIA
    WHERE A.EXCLUSION_COMERCIAL IS NULL
      AND A.GRUPO_CONTROL IS NULL
      AND B.BAN_AUTORIZACION_ENVIO = 'SI'
      AND TRUNC(B.FECHA) >= DATE '2025-09-01'
    UNION ALL 
    SELECT 
    	'HOGAR',
        COUNT(DISTINCT CASE WHEN B_HOGAR = 'TRUE' THEN A.TELE_NUMB END ) AS POTENCIAL_TOTAL,
        COUNT(DISTINCT CASE WHEN B_HOGAR = 'TRUE' AND CANAL_SMS = 'TRUE' THEN A.TELE_NUMB END) AS POTENCIAL_SMS, 
        COUNT(DISTINCT CASE WHEN B_HOGAR = 'TRUE' AND CANAL_RCS = 'TRUE' THEN A.TELE_NUMB END) AS POTENCIAL_RCS, 
        COUNT(DISTINCT CASE WHEN B_HOGAR = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE' THEN A.TELE_NUMB END) AS POTENCIAL_SAT_PUSH,
        COUNT(DISTINCT CASE WHEN B_HOGAR = 'TRUE' AND CANAL_WHATSAPP = 'TRUE' THEN A.TELE_NUMB END) AS POTENCIAL_WHATSAPP,
        COUNT(DISTINCT CASE WHEN B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP = 'TRUE' THEN A.TELE_NUMB END) AS POTENCIAL_PUSH_APP,
        COUNT(DISTINCT CASE WHEN B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE' THEN A.TELE_NUMB END) AS POTENCIAL_PUSH_COTA,                 
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_SMS ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_SMS,
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_RCS ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_RCS,
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_SAT_PUSH ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_SAT_PUSH,
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_WHATSAPP ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_WHATSAPP,
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_NOTIFICACION_PUSH_APP,       
        COUNT(DISTINCT CASE 
            WHEN A.P_MIGRA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA ='TRUE' AND C.BUSINESS_UNIT = 'MIGRACION'
            THEN A.TELE_NUMB END) AS POTENCIAL_MIGRACION_NOTIFICACION_PUSH_COTA ,              
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_SMS = 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_SMS,
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_RCS= 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_RCS,        
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_SAT_PUSH,
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_WHATSAPP = 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_WHATSAPP,        
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP= 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_NOTIFICACION_PUSH_APP,   
        COUNT(DISTINCT CASE 
            WHEN A.P_CONVERGENCIA = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA= 'TRUE' AND C.BUSINESS_UNIT = 'CONVERGENCIA'
            THEN A.TELE_NUMB END) AS POTENCIAL_CONVERGENCIA_NOTIFICACION_PUSH_COTA,          
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_SMS = 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_SMS,     
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_RCS = 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_RCS,        
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_SAT_PUSH = 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_SAT_PUSH,
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_WHATSAPP= 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_WHATSAPP,        
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP= 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_NOTIFICATION_PUSH_APP,     
        COUNT(DISTINCT CASE 
            WHEN A.P_TYT = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE' AND C.BUSINESS_UNIT = 'T&T'
            THEN A.TELE_NUMB END) AS POTENCIAL_TYT_NOTIFICATION_PUSH_COTA,                  
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_SMS = 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_SMS,
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_RCS = 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_SMS,        
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_SAT_PUSH= 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_SAT_PUSH,
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_WHATSAPP= 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_WHATSAPP,
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_APP = 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_CANAL_NOTIFICATION_PUSH_APP,     
        COUNT(DISTINCT CASE 
            WHEN A.P_OTT_NETFLIX = 'TRUE' AND A.B_HOGAR = 'TRUE' AND CANAL_NOTIFICATION_PUSH_COTA = 'TRUE' AND C.PRODUCT = 'OTT'
            THEN A.TELE_NUMB END) AS POTENCIAL_OTT_CANAL_NOTIFICATION_PUSH_COTA           
    FROM POTENCIAL_CAMPANA A
    JOIN VW_TBL_FACT_AUT_TCM B
    ON RIGHT(A.TELE_NUMB,10) = RIGHT(B.TELE_NUMB,10) 
    JOIN GROWTH_CAMPAIGN_OPTION C
    ON B.NEMOTECNIA = C.NEMOTECNIA
    WHERE A.EXCLUSION_COMERCIAL IS NULL
      AND A.GRUPO_CONTROL IS NULL
      AND B.BAN_AUTORIZACION_ENVIO = 'SI'
      AND TRUNC(B.FECHA) >= DATE '2025-09-01';
